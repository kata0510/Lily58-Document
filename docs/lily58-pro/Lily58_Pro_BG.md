# Lily58 Pro 組み立て方

この基板(PCB)はリバーシブルタイプです**片面づつに**部品を実装していきます。
## マスキングテープを取り付ける
:::note info  
必要なもの   
・マスキングテープ
:::

裏表をわかりやすくするためマスキングテープなどを表面に貼り付けます。
![DSC05480.jpg](/img/DSC05480.jpg)

## ダイオードはんだ付けする
:::note info
必要なもの    
・はんだごて   
・はんだ  
・ピンセット   
・ダイオード
:::

:::caution
    ダイオードの取り付けは**テープを貼り付けてない基板裏側**に行います。
:::

ダイオードを取り付ける場所に予備はんだをします。  
パッドの片方にはんだごてを当て、はんだを少し溶かします。
![DSC05481.jpg](/img/DSC05481.jpg)
:::note info
    リールの中に入ったチップダイオードを使用しています。    
    取り出す際に飛んでいかないようにゆっくりと開封してください。
:::
ダイオードに刻印されている線と基板のダイオードのマークの線の向きを合わせてはんだ付けを行います。
向きが正しくないとキーが反応しません。
![2019-02-28 14 08 00](https://user-images.githubusercontent.com/6285554/53542561-53300300-3b62-11e9-8b83-5758ce400491.png)
![DSC05484.jpg](/img/DSC05484.jpg)

ピンセットを使用してダイオードをはんだ付けします。  
ダイオードの片側を予備はんだを使用して固定してから反対側もはんだ付けします。
![DSC05487.jpg](/img/DSC05487.jpg)

残りのダイオードも同じ要領ではんだ付けします。  
1.予備はんだを行う
![DSC05488.jpg](/img/DSC05488.jpg)
2.予備はんだを使ってダイオードを仮固定する。
![DSC05489.jpg](/img/DSC05489.jpg)
3.ダイオードをはんだ付けする。
![DSC05490.jpg](/img/DSC05490.jpg)

## OLED用のジャンパを行う
OLEDを使用するためにジャンパを行います。
左右の表面のみジャンパを行ってください。
![DSC05587.jpg](/img/DSC05587.jpg)
## Pro Microを取り付ける 
:::note info  
必要なもの   
    ・はんだごて  
    ・はんだ  
    ・ProMicro(コンスルー付き)  
::: 
:::caution
    ProMicroの袋に同封されているピンヘッダの使用はProMicroが破損した際に交換ができないため推奨しません。    
    このビルドガイドではコンスルーの使用を前提とした記載をしています。
:::
![DSC05492.jpg](/img/DSC05492.jpg)

コンスルーを**PCBの線で囲まれている列を確認して**PCB表面に差し込みます。    
左右で差し込む場所が異なるため注意してください。 
![ProMicro_PCB](https://user-images.githubusercontent.com/6285554/48819671-6a599a80-ed94-11e8-8e5d-6a6abca326a7.png)
![DSC05495.jpg](/img/DSC05495.jpg)
ProMicroを乗せ、押し込みます。
![DSC05496.jpg](/img/DSC05496.jpg)
![DSC05497.jpg](/img/DSC05497.jpg)
ProMicroをはんだ付けします。
:::caution
    ProMicroを取り外し可能にするため、はんだ付けする際は表面のみはんだ付けしてください。    
    裏面にははんだ付けを行わないでください。
:::
![DSC05499.jpg](/img/DSC05499.jpg)

## TRRSジャック リセットボタンをはんだ付けする
:::note info  
必要なもの   
    ・はんだごて  
    ・はんだ  
    ・TRRSジャック  
    ・リセットボタン
:::

TRRSジャックを基板に差し込み、マスキングテープなどで仮固定して裏側からはんだ付けします。
![DSC05500.jpg](/img/DSC05500.jpg)
![DSC05501.jpg](/img/DSC05501.jpg)
![DSC05502.jpg](/img/DSC05502.jpg)
リセットボタンを基板に差し込み、裏側からはんだ付けします。
![DSC05509.jpg](/img/DSC05509.jpg)
![DSC05511.jpg](/img/DSC05511.jpg)

## ProMicroの動作確認を行う
:::note info  
必要なもの   
    ・TRRSケーブル  
    ・MicroUSBケーブル  
    ・ピンセット
    ・動作確認をするパソコン
:::
Remapのサイト上でファームウェアの書き込みと動作確認を行います。     
TRRSケーブルを奥まで差し込み、左側のProMicroにUSBケーブルを差し込みます。
![DSC05513.jpg](/img/DSC05513.jpg)
![DSC05514.jpg](/img/DSC05514.jpg)
:::caution
    Chrome 89以上を使用してアクセスを行ってください
:::
- [ファームウェア書き込みページ](https://remap-keys.app/catalog/jztXFjMO9ZAIzyFT7CSe/firmware)

`Lily58 VIA Firmware(No OLED)`の`FLASH`を選択しChromeのダイアログが出てきたらLily58のリセットボタンを押します。   
Lily58を選択して接続後、問題がなければ書き込みが行われます。
![remap1.png](/img/remap1.png)
![remap2.png](/img/remap2.png)
![remap3.png](/img/remap3.png)
![remap4.png](/img/remap4.png)

USBケーブルを反対側に差し替え、`FLASH`をクリックし、**右側のProMicroにも**ファームウェアの書き込みを行います。
右側のProMicroへの書き込み終了後、USBケーブルを左側のProMicroに刺し戻します。

[動作確認ページ](https://remap-keys.app/configure)へアクセスします。    
`+ KEYBOARD`をクリックしChromeのダイアログ上のLily58を選択肢し、接続します。    
![remap5.png](/img/remap5.png)  
右下メニューの`Test Matrix mode`を選択し、動作確認を行います。  
![remap6.png](/img/remap6.png)  
動作確認はピンセットなど導通するものを使用し、写真のようにショートさせることで動作確認を行います。 
Test Matrixの画面を見ながらすべて動作するか確認します。 
![DSC05515.jpg](/img/DSC05515.jpg)
ダイオードの取り付けや基板、ProMicroに問題がない場合すべて青く変わります。
![remap7.png](/img/remap7.png)  

## ソケットをはんだ付けする
:::note info  
必要なもの
    ・はんだごて  
    ・はんだ  
    ・ピンセット
    ・スイッチソケット 
:::
ソケットはダイオードと同じ裏面に取り付けをします。

ダイオードと同じようにソケットのパッドの片方に予備はんだをし、ソケットを載せ、ピンセットや手で抑えながらはんだ付けをします。(手で抑える場合は火傷にご注意ください。)  
MXソケットの場合は上側に、Chocソケット(ロープロファイル版)の場合は下側に取り付けます。  
![socket](https://user-images.githubusercontent.com/6285554/57197682-3de1b580-6fa5-11e9-90b1-fca894e1e7d2.png)
![DSC05517.jpg](/img/DSC05517.jpg)
![DSC05518.jpg](/img/DSC05518.jpg)

同じように予備はんだを行い、片方を仮はんだ、両側をしっかりとはんだ付けします。
力がかかる部品のため、はんだ忘れやソケットの浮きがないか確認をします。  
![DSC05523.jpg](/img/DSC05523.jpg)
![DSC05526.jpg](/img/DSC05526.jpg)

## OLEDを取り付ける
:::note info  
必要なもの   
    ・はんだごて  
    ・はんだ  
    ・マスキングテープ   
    ・OLEDモジュール   
:::
表面につけていたマスキングテープを剥がし、OLEDソケットを差し込みます。
OLEDソケットを裏側からはんだ付けするためにマスキングテープで固定します。この際に真っ直ぐに固定されているか確認します。

![DSC05570.jpg](/img/DSC05570.jpg)
裏側からはんだ付けします。
:::caution
    はんだを流しすぎるとソケット内部まで流れ込んでしまいますので注意して作業を行ってください。
:::
![DSC05571.jpg](/img/DSC05571.jpg)
OLEDソケットを固定していたマスキングテープを剥がし、OLED用ピンを差し込みます。
![DSC05580.jpg](/img/DSC05580.jpg)
その上にOLEDモジュールを乗せ、4箇所をはんだ付けします。
はんだ付け後、OLEDモジュールのフィルムを剥がします。
![DSC05581.jpg](/img/DSC05581.jpg)

これより先の組み立てでははんだごてを使わないため、はんだごての電源をオフにしてください。
## スイッチの取り付け
:::note info  
必要なもの   
    ・トッププレート    
    ・ねじ  
    ・六角スペーサー(短)    
    ・精密プラスドライバー  
    ・キースイッチ
:::
トッププレート、ねじ、六角7mmスペーサー(短)を用意します。
![DSC05593.jpg](/img/DSC05593.jpg)
トッププレートにネジとスペーサーを仮止めします。
![DSC05595.jpg](/img/DSC05595.jpg)
トッププレート四隅にキースイッチをしっかりと差し込み、Lily58 Pro基板に重ねて差し込みます。
![DSC05599.jpg](/img/DSC05599.jpg)
:::caution
    スイッチのピンが曲がらないように気をつけながら差し込みを行ってください。
:::
![DSC05600.jpg](/img/DSC05600.jpg)
残りのスイッチを差し込みます。
![DSC05601.jpg](/img/DSC05601.jpg)

## ProMicro保護プレートの取り付け
:::note info  
必要なもの   
    ・ProMicro保護プレート   
    ・ねじ   
    ・丸スペーサー(長)    
    ・精密プラスドライバー
:::
ねじ、10mm丸スペーサー(長)を用意し、ドライバー等を使ってしっかりと取り付けます。
![DSC05602.jpg](/img/DSC05602.jpg)
![DSC05603.jpg](/img/DSC05603.jpg)
ProMicro保護プレートを用意し、向きを確認します
幅が広いほうが外側、幅が広いほうが内側(スイッチ側)となります。
![DSC05607.jpg](/img/DSC05607.jpg)
保護プレートのフィルムを剥がし、ネジ止めします。
![DSC05612.jpg](/img/DSC05612.jpg)

## バックプレートの取り付け
:::note info  
必要なもの   
    ・ねじ   
    ・精密プラスドライバー  
    ・ゴム足
:::
バックプレートとネジを用意し、バックプレートとゴム足を取り付けます。
![DSC05615.jpg](/img/DSC05615.jpg)
トッププレート取り付け後、トッププレートのネジを締め直します。

## ファームウェアを書き込む
:::note info  
必要なもの
    ・TRRSケーブル  
    ・MicroUSBケーブル  
    ・動作確認をするパソコン
:::
ProMicroの動作確認時に使用したRemapを使用して再度ファームウェアを書き込みを行います。
- [ファームウェア書き込みページ](https://remap-keys.app/catalog/jztXFjMO9ZAIzyFT7CSe/firmware)  
`Lily58 VIA Firmware`の`FLASH`を選択しChromeのダイアログが出てきたらLily58のリセットボタンを押し、ファームウェアを書き込みます。
![remap8.png](/img/remap8.png)

[動作確認ページ](https://remap-keys.app/configure)へアクセスし、動作確認をします。
![remap5.png](/img/remap5.png)
![remap6.png](/img/remap6.png)
![remap7.png](/img/remap7.png)
このページでキーマップの変更も行えます。お好みのキーマップに変更してみましょう。

## 完成
キーキャップを取り付けて完成です。組み立てお疲れさまでした。
![lily58.jpeg](/img/lily58.jpeg)